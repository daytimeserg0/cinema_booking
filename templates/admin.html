<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel - Cinema Booking</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}">
</head>
<body>
    <h1>Admin Panel</h1>
    <p>Welcome, {{ session.username }}!</p>
    <p><a href="/">Back to Home</a></p>

    <!-- List of existing halls -->
    <h2>Existing Halls</h2>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, msg in messages %}
                    {% if category.startswith('delete_hall_') %}
                        <div class="message {{ category }}">{{ msg }}</div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% endwith %}
      {% if halls %}
          <table>
              <tr>
                  <th>ID</th>
                  <th>Name</th>
                  <th>Rows</th>
                  <th>Seats per Row</th>
                  <th>Action</th>
              </tr>
              {% for hall in halls %}
              <tr>
                  <td>{{ hall[0] }}</td>
                  <td>{{ hall[1] }}</td>
                  <td>{{ hall[2] }}</td>
                  <td>{{ hall[3] }}</td>
                  <td>
                      <form method="POST" style="display:inline;">
                          <button type="submit" name="delete_hall" class="delete_hall" value="{{ hall[0] }}" onclick="return confirm('Are you sure you want to delete this hall?');">
                              Delete
                          </button>
                      </form>
                  </td>
              </tr>
              {% endfor %}
          </table>
      {% else %}
          <p>No halls available.</p>
      {% endif %}

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, msg in messages %}
                {% if category.startswith('add_hall_') %}
                    <div class="message {{ category }}">{{ msg }}</div>
                {% endif %}
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Button to show the form -->
    <button id="showAddHallForm" class="add_hall">Add New Hall ▼</button>

    <div id="addHallForm" style="display:none; margin-top: 20px;">

        <form method="POST">
            <input type="text" name="name" placeholder="Hall Name" required><br>
            <input type="number" name="rows" placeholder="Number of Rows" min="1" required><br>
            <input type="number" name="seats_per_row" placeholder="Seats per Row" min="1" required><br><br>
            <button type="submit" name="add_hall" class="add_hall">Submit</button>
        </form>
    </div>

    <!-- JavaScript to toggle form visibility -->
    <script>
        const btn = document.getElementById('showAddHallForm');
        const form = document.getElementById('addHallForm');

        btn.addEventListener('click', function() {
            if (form.style.display === 'none') {
                form.style.display = 'block';
                btn.textContent = "Hide Form ▲"; // текст меняется
            } else {
                form.style.display = 'none';
                btn.textContent = "Add New Hall ▼"; // обратно
            }
        });
    </script>

</body>
</html>
